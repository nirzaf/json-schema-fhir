"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parsePOSTJsonRequest = exports.isPOSTJsonRequest = void 0;
const utils_1 = require("@graphql-tools/utils");
const utils_js_1 = require("./utils.js");
function isPOSTJsonRequest(request) {
    return (request.method === 'POST' &&
        ((0, utils_js_1.isContentTypeMatch)(request, 'application/json') ||
            (0, utils_js_1.isContentTypeMatch)(request, 'application/graphql+json')));
}
exports.isPOSTJsonRequest = isPOSTJsonRequest;
async function parsePOSTJsonRequest(request) {
    try {
        const requestBody = await request.json();
        if (typeof requestBody !== 'object' || requestBody == null) {
            throw (0, utils_1.createGraphQLError)('POST body sent invalid JSON.', {
                extensions: {
                    http: {
                        status: 400,
                    },
                },
            });
        }
        return requestBody;
    }
    catch (err) {
        throw (0, utils_1.createGraphQLError)('POST body sent invalid JSON.', {
            extensions: {
                http: {
                    status: 400,
                },
            },
        });
    }
}
exports.parsePOSTJsonRequest = parsePOSTJsonRequest;
